<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Argumentative Essay Feedback Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #A2D2FF;
            color: #00203D; /* Dark blue for text */
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 2rem;
            margin: 0;
            line-height: 1.6;
        }
        .container {
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            max-width: 800px;
            width: 100%;
        }
        #essayInput {
            background-color: #EBF5FF;
            color: #00203D;
            border: 1px solid #b3e5fc;
            transition: all 0.3s ease;
        }
        #essayInput:focus {
            border-color: #0288d1;
            box-shadow: 0 0 0 3px rgba(2, 136, 209, 0.2);
            outline: none;
        }
        #analyzeButton {
            background-color: #0288d1;
            color: white;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        #analyzeButton:hover {
            background-color: #01579b;
            transform: translateY(-2px);
        }
        .trait-card {
            background-color: #EBF5FF;
            border: 1px dashed #42a5f5;
            color: #00203D;
            box-shadow: none;
            padding: 1.5rem; /* Adjust padding for a cleaner look */
            transition: transform 0.2s ease;
        }
        .trait-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .trait-stage {
            background-color: #b3e5fc;
            color: #01579b;
            font-weight: 600;
        }
    </style>
</head>
<body class="p-8">

    <div class="container rounded-2xl shadow-lg p-8 space-y-8">
        <header class="text-center">
            <h1 class="text-4xl font-extrabold text-[#0288d1] tracking-tight mb-2">Argumentative Essay Feedback Tool</h1>
            <p class="text-lg text-[#00203D] opacity-80 italic">Paste a student essay below to get a breakdown based on the six traits of quality writing.</p>
        </header>

        <main class="space-y-6">
            <div class="space-y-2">
                <label for="essayInput" class="block text-xl font-semibold text-[#01579b]">Student Essay</label>
                <textarea id="essayInput" class="w-full h-80 p-4 rounded-lg shadow-sm resize-y" placeholder="Paste the student's essay here..."></textarea>
            </div>

            <div class="flex justify-center">
                <button id="analyzeButton" class="px-8 py-3 font-bold rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50">
                    Evaluate Essay
                </button>
            </div>

            <div id="messageArea" class="hidden mt-4 p-4 rounded-xl text-center font-medium bg-red-100 text-red-700"></div>

            <div id="loadingIndicator" class="hidden text-center text-[#01579b] font-semibold text-lg">
                Analyzing essay...
            </div>

            <div id="results" class="space-y-6 hidden">
                <h2 class="text-3xl font-bold text-[#01579b] text-center pt-4">Heuristic Evaluation Results</h2>
                <p id="overallGrade" class="text-center text-xl font-medium text-[#00203D]"></p>
                <div id="traitResults" class="grid md:grid-cols-2 gap-6">
                    <!-- Heuristic results will be dynamically inserted here -->
                </div>
            </div>
        </main>
    </div>

    <script>
        const API_KEY = ""; // Keep this empty
        const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=" + API_KEY;

        const rubric = {
            development: {
                title: "Overall Development",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "The response is a list or sentence that may or may not be related to the topic. The response is too brief to get a clear sense of meaning." },
                    { stage: "Stage 2", label: "Developing", description: "The response is a series of sentences related to the topic. The writer may stray from the main point. The writer may write in a personal style rather than an academic one." },
                    { stage: "Stage 3", label: "Competent", description: "The writer responds to the prompt, but the thesis or claim may not be clear. The introduction may be missing or uninspired. The conclusion may be missing or weak. Some parts of the essay may not relate to the main idea." },
                    { stage: "Stage 4", label: "Proficient", description: "The essay has a clear thesis or claim. The introduction and conclusion are well-written and relate to the thesis. The essay has a consistent focus on the topic. The writer does not wander from the main point." },
                    { stage: "Stage 5", label: "Exemplary", description: "The essay has a clear, compelling thesis or claim. The introduction grabs the reader's attention and provides necessary background information. The conclusion summarizes the main ideas and leaves the reader with a new idea to consider. The essay is focused and addresses the complexities of the topic." },
                    { stage: "Stage 6", label: "Exceptional", description: "The essay demonstrates an insightful understanding of the topic. The writer may present a unique or original argument and offer a fresh perspective on the topic. The essay's introduction and conclusion are memorable and fully explore the significance of the argument." }
                ]
            },
            organization: {
                title: "Organization",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "Ideas are not organized in any order. The paper has no paragraphs or paragraphs are a single sentence." },
                    { stage: "Stage 2", label: "Developing", description: "The essay is somewhat organized but may be illogical. It may include a single paragraph or paragraphs that do not relate to one another. There are very few transitions." },
                    { stage: "Stage 3", label: "Competent", description: "The essay is organized, but it may have parts that are out of place. The introduction may not have a thesis and the conclusion may not connect to the introduction. Transitions are few and not always effective." },
                    { stage: "Stage 4", label: "Proficient", description: "A clear, consistent pattern of organization is evident throughout the essay. Each paragraph has a clear topic sentence and relates to the thesis. The conclusion effectively summarizes the main points. The writer may use transitions, but not always effectively." },
                    { stage: "Stage 5", label: "Exemplary", description: "The writer uses an effective organizational pattern throughout the essay. The writer includes a clear introduction, body, and conclusion. Each paragraph has a clear topic sentence that relates to the thesis. The writer uses strong transitions between ideas." },
                    { stage: "Stage 6", "label": "Exceptional", description: "The writer uses a complex organizational pattern. The writer's transitions guide the reader through the essay. The essay may use literary devices like foreshadowing or flashbacks." }
                ]
            },
            support: {
                title: "Support",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "The essay does not have any support for the claim." },
                    { stage: "Stage 2", label: "Developing", description: "The essay contains some support, but it is not relevant or may be unclear. The writer may not have used information from provided sources." },
                    { stage: "Stage 3", label: "Competent", description: "The essay contains some relevant support for the claim, but it may not be explained well. The writer may use information from provided sources, but it may not be cited. Some information may be plagiarized." },
                    { stage: "Stage 4", label: "Proficient", description: "The essay contains relevant and sufficient support. The writer has used information from provided sources, but has not cited it. Some of the support may not be fully explained." },
                    { stage: "Stage 5", label: "Exemplary", description: "The essay contains relevant and sufficient support. The writer has used evidence from provided sources and has cited them. The writer fully explains the evidence." },
                    { stage: "Stage 6", label: "Exceptional", description: "The essay contains rich, sophisticated, and insightful support. The writer may use a variety of sources and cite them correctly. The writer's explanations are complex and thorough." }
                ]
            },
            sentenceStructure: {
                title: "Sentence Structure",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "The writer uses short sentences that do not flow together. Many sentences are sentence fragments or run-ons." },
                    { stage: "Stage 2", label: "Developing", description: "The writer uses some run-ons and fragments. The sentences may not vary in length or type. The writer may use simple sentences throughout the essay." },
                    { stage: "Stage 3", label: "Competent", description: "The writer uses some variety in sentence length and type, but may also use simple sentences. The writer may have a few fragments or run-ons." },
                    { stage: "Stage 4", label: "Proficient", description: "The writer uses some variety in sentence length and type. The writer may use compound and complex sentences. The writer does not use run-ons or fragments." },
                    { stage: "Stage 5", label: "Exemplary", description: "The writer uses a variety of sentence lengths and types, including compound-complex sentences. The sentences flow together and are easy to read. The essay is free of fragments and run-ons." },
                    { stage: "Stage 6", label: "Exceptional", description: "The writer uses a wide variety of sentence lengths and types to create a rhythm. The writer may use parallelism, anaphora, or other rhetorical devices to create a desired effect." }
                ]
            },
            wordChoice: {
                title: "Word Choice",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "The writer uses simple, repetitive vocabulary. The writer may use slang or informal language. The essay is difficult to understand." },
                    { stage: "Stage 2", label: "Developing", description: "The writer uses repetitive vocabulary. The writer may use slang or informal language. The writer may have some errors in word choice." },
                    { stage: "Stage 3", label: "Competent", description: "The writer uses a slightly varied vocabulary. The writer may use some slang or informal language. The writer has a few errors in word choice." },
                    { stage: "Stage 4", label: "Proficient", description: "The writer uses a varied vocabulary. The writer may use some sophisticated vocabulary. The writer does not use slang or informal language." },
                    { stage: "Stage 5", label: "Exemplary", description: "The writer uses a rich, varied, and sophisticated vocabulary. The writer's word choice is precise and appropriate. The writer does not use any slang or informal language." },
                    { stage: "Stage 6", label: "Exceptional", description: "The writer uses an exceptional vocabulary. The writer's word choice is precise, vivid, and powerful. The writer may use figurative language such as metaphors or similes." }
                ]
            },
            mechanics: {
                title: "Mechanics",
                stages: [
                    { stage: "Stage 1", label: "Beginning", description: "The writer has many errors in spelling, capitalization, punctuation, and grammar. The writer may not use a spell checker. The essay is difficult to read." },
                    { stage: "Stage 2", label: "Developing", description: "The writer has many errors in spelling, capitalization, punctuation, and grammar. The writer may have used a spell checker, but has not corrected all of the errors. The essay is difficult to read." },
                    { stage: "Stage 3", label: "Competent", description: "The writer has a few errors in spelling, capitalization, punctuation, and grammar. The writer may not have used a spell checker. The essay is readable." },
                    { stage: "Stage 4", label: "Proficient", description: "The writer has very few errors in spelling, capitalization, punctuation, and grammar. The writer has used a spell checker and has corrected most of the errors. The essay is easy to read." },
                    { stage: "Stage 5", label: "Exemplary", description: "The writer has very few errors in spelling, capitalization, punctuation, and grammar. The writer has used a spell checker and has corrected all of the errors. The essay is very easy to read." },
                    { stage: "Stage 6", label: "Exceptional", description: "The writer has no errors in spelling, capitalization, punctuation, and grammar. The essay is perfectly polished and easy to read." }
                ]
            }
        };

        // Heuristic analysis function
        function evaluateEssay(essayText) {
            const results = {};
            const paragraphs = essayText.split(/\n\s*\n/).filter(p => p.trim() !== '');
            const sentences = essayText.split(/[.!?]\s/).filter(s => s.trim() !== '');
            const words = essayText.toLowerCase().split(/\s+/).filter(w => w !== '');
            const totalWords = words.length;

            // --- Heuristic for Development ---
            let developmentStage = 1;
            const hasIntroduction = paragraphs.length > 0 && paragraphs[0].length > 50;
            const hasConclusion = paragraphs.length > 1 && paragraphs[paragraphs.length - 1].length > 50;
            const hasClearThesisKeywords = /(I believe|It is clear that|In my opinion|The primary argument is|The central claim is|This essay will argue)/i.test(essayText);
            const isFocused = words.length > 200 && (new Set(words).size / totalWords) > 0.4;
            if (totalWords > 50) developmentStage = 2;
            if (paragraphs.length > 1 && hasIntroduction) developmentStage = 3;
            if (paragraphs.length >= 3 && hasClearThesisKeywords && hasConclusion) developmentStage = 4;
            if (isFocused && developmentStage >= 4) developmentStage = 5;
            if (isFocused && developmentStage === 5 && totalWords > 400) developmentStage = 6;
            results.development = rubric.development.stages[Math.min(developmentStage, 6) - 1];

            // --- Heuristic for Organization ---
            let organizationStage = 1;
            const hasParagraphs = paragraphs.length > 1;
            const hasTopicSentences = paragraphs.every(p => /^[A-Z]/.test(p.trim()));
            const hasTransitions = /(first|second|next|then|finally|in conclusion|furthermore|however|consequently)/i.test(essayText);
            if (hasParagraphs) organizationStage = 2;
            if (hasParagraphs && paragraphs.length >= 3) organizationStage = 3;
            if (hasTopicSentences && hasParagraphs) organizationStage = 4;
            if (hasTransitions && hasTopicSentences) organizationStage = 5;
            if (hasTransitions && hasTopicSentences && paragraphs.length > 5) organizationStage = 6;
            results.organization = rubric.organization.stages[Math.min(organizationStage, 6) - 1];

            // --- Heuristic for Support ---
            let supportStage = 1;
            const hasEvidenceKeywords = /(for example|for instance|according to|research shows|a study found|as cited in)/i.test(essayText);
            const hasNumericalData = /\d+/.test(essayText);
            if (hasEvidenceKeywords || hasNumericalData) supportStage = 2;
            if (hasEvidenceKeywords && hasNumericalData) supportStage = 3;
            if (sentences.some(s => s.includes(" and ") || s.includes(","))) supportStage = 4;
            if (sentences.some(s => s.includes(" thus ") || s.includes(" therefore "))) supportStage = 5;
            if (sentences.length > 20 && sentences.some(s => s.length > 30)) supportStage = 6;
            results.support = rubric.support.stages[Math.min(supportStage, 6) - 1];

            // --- Heuristic for Sentence Structure ---
            let sentenceStructureStage = 1;
            const sentenceLengths = sentences.map(s => s.split(' ').length);
            const hasShortSentences = sentenceLengths.some(len => len <= 5);
            const hasLongSentences = sentenceLengths.some(len => len >= 20);
            const sentenceVariance = hasShortSentences && hasLongSentences;
            const hasComplexSentences = /\,( and| but| or| nor| for| so| yet)/.test(essayText) || /^(while|since|although|because|if|as)/i.test(essayText);
            if (sentenceLengths.length > 5) sentenceStructureStage = 2;
            if (sentenceVariance) sentenceStructureStage = 3;
            if (hasComplexSentences) sentenceStructureStage = 4;
            if (sentenceVariance && hasComplexSentences) sentenceStructureStage = 5;
            if (sentenceVariance && hasComplexSentences && sentences.length > 25) sentenceStructureStage = 6;
            results.sentenceStructure = rubric.sentenceStructure.stages[Math.min(sentenceStructureStage, 6) - 1];

            // --- Heuristic for Word Choice ---
            let wordChoiceStage = 1;
            const uniqueWords = new Set(words).size;
            const wordVariety = uniqueWords / totalWords;
            const sophisticatedWords = /(consequently|furthermore|moreover|therefore|additionally|nonetheless|nevertheless|subsequently)/i;
            const hasSophisticatedWords = sophisticatedWords.test(essayText);
            if (wordVariety > 0.4) wordChoiceStage = 2;
            if (wordVariety > 0.5) wordChoiceStage = 3;
            if (wordVariety > 0.6) wordChoiceStage = 4;
            if (wordVariety > 0.7 && hasSophisticatedWords) wordChoiceStage = 5;
            if (wordVariety > 0.8 && hasSophisticatedWords && totalWords > 300) wordChoiceStage = 6;
            results.wordChoice = rubric.wordChoice.stages[Math.min(wordChoiceStage, 6) - 1];

            // --- Heuristic for Mechanics ---
            let mechanicsStage = 1;
            const basicErrors = /( i | i'm | its | its'| theres | there's | your | you're)/i; // Very simple checks
            const hasCapitalizationErrors = sentences.some(s => !s.trim().match(/^[A-Z]/));
            const hasPunctuationErrors = sentences.some(s => !s.trim().match(/[.!?]$/));
            if (!basicErrors.test(essayText)) mechanicsStage = 2;
            if (!hasCapitalizationErrors) mechanicsStage = 3;
            if (!hasPunctuationErrors) mechanicsStage = 4;
            if (!basicErrors.test(essayText) && !hasCapitalizationErrors && !hasPunctuationErrors) mechanicsStage = 5;
            if (!basicErrors.test(essayText) && !hasCapitalizationErrors && !hasPunctuationErrors && totalWords > 200) mechanicsStage = 6;
            results.mechanics = rubric.mechanics.stages[Math.min(mechanicsStage, 6) - 1];

            return results;
        }

        const essayInput = document.getElementById('essayInput');
        const analyzeButton = document.getElementById('analyzeButton');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const resultsDiv = document.getElementById('results');
        const traitResultsDiv = document.getElementById('traitResults');
        const messageArea = document.getElementById('messageArea');

        function showMessage(text, isError = false) {
            messageArea.textContent = text;
            messageArea.classList.remove('hidden');
            if (isError) {
                messageArea.classList.add('bg-red-100', 'text-red-700');
                messageArea.classList.remove('bg-green-100', 'text-green-700');
            } else {
                messageArea.classList.add('bg-green-100', 'text-green-700');
                messageArea.classList.remove('bg-red-100', 'text-red-700');
            }
        }

        analyzeButton.addEventListener('click', () => {
            const essayText = essayInput.value.trim();
            messageArea.classList.add('hidden');
            if (essayText.length < 50) {
                showMessage("Please enter a longer essay (at least 50 words) to get a meaningful evaluation.", true);
                return;
            }

            resultsDiv.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');

            setTimeout(() => {
                const results = evaluateEssay(essayText);
                loadingIndicator.classList.add('hidden');
                resultsDiv.classList.remove('hidden');

                traitResultsDiv.innerHTML = '';
                let overallScore = 0;
                let count = 0;

                for (const trait in results) {
                    const result = results[trait];
                    const stage = rubric[trait].stages.findIndex(s => s.stage === result.stage) + 1;
                    overallScore += stage;
                    count++;

                    const card = document.createElement('div');
                    card.classList.add('trait-card', 'rounded-xl');
                    card.innerHTML = `
                        <h3 class="text-xl font-bold mb-2">${rubric[trait].title}</h3>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="px-3 py-1 text-sm rounded-full trait-stage">
                                ${result.stage}
                            </span>
                            <span class="text-lg font-medium text-gray-700">${result.label}</span>
                        </div>
                        <p class="text-gray-600">${result.description}</p>
                    `;
                    traitResultsDiv.appendChild(card);
                }

                const averageScore = overallScore / count;
                const overallGradeElement = document.getElementById('overallGrade');
                overallGradeElement.textContent = `Overall Score: ${averageScore.toFixed(1)} / 6.0`;
            }, 500); // Simulate a short delay for analysis
        });
    </script>
</body>
</html>
